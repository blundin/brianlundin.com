sudo: required

os: osx
language: node_js
node_js:
  - "10"

branches:
  only:
  - development
  - publishing

before_install:
  - rvm install 2.5.1
  - yarn global add gulp-cli

cache:
  yarn: true
  bundler: true
  directories:
    - /node_modules/
    - /aws-caches/
    - /vendor/bundle/

install:
  - yarn install --production=false --ignore-optional
  - bundle install

jobs:
  include:
    - stage: staging-job
      if: branch = development OR branch = staging
      script: gulp staging
    - stage: publishing-job
      if: branch = publishing
      script: gulp publish
